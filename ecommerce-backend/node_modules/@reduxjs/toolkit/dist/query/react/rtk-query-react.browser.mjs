import{buildCreateApi as Le,coreModule as we}from"@reduxjs/toolkit/query";import"@reduxjs/toolkit";import{batch as Se,useDispatch as Be,useSelector as he,useStore as Ee}from"react-redux";import{createSelector as be}from"reselect";function J(e){return e.type==="query"}function Y(e){return e.type==="mutation"}function L(e,...i){return Object.assign(e,...i)}function C(e){return e.replace(e[0],e[0].toUpperCase())}import{createAction as Ke,createSlice as Ve,createSelector as _e,createAsyncThunk as je,combineReducers as We,createNextState as $e,isAnyOf as Ge,isAllOf as Ze,isAction as Je,isPending as Ye,isRejected as Xe,isFulfilled as et,isRejectedWithValue as tt,isAsyncThunkAction as rt,prepareAutoBatched as nt,SHOULD_AUTOBATCH as it,isPlainObject as $,nanoid as st}from"@reduxjs/toolkit";import{formatProdErrorMessage as fe}from"@reduxjs/toolkit";import"@reduxjs/toolkit";import{QueryStatus as Qe,skipToken as K}from"@reduxjs/toolkit/query";import{useCallback as V,useDebugValue as re,useEffect as F,useLayoutEffect as le,useMemo as B,useRef as O,useState as ne}from"react";import{shallowEqual as Z}from"react-redux";var X=WeakMap?new WeakMap:void 0,ee=({endpointName:e,queryArgs:i})=>{let T="",R=X?.get(i);if(typeof R=="string")T=R;else{let m=JSON.stringify(i,(D,c)=>(c=typeof c=="bigint"?{$bigint:c.toString()}:c,c=$(c)?Object.keys(c).sort().reduce((h,E)=>(h[E]=c[E],h),{}):c,c));$(i)&&X?.set(i,m),T=m}return`${e}(${T})`};var w=Symbol();import{useEffect as ae,useRef as ye,useMemo as pe}from"react";function G(e,i,T,R){let m=pe(()=>({queryArgs:e,serialized:typeof e=="object"?i({queryArgs:e,endpointDefinition:T,endpointName:R}):e}),[e,i,T,R]),D=ye(m);return ae(()=>{D.current.serialized!==m.serialized&&(D.current=m)},[m]),D.current.serialized===m.serialized?D.current.queryArgs:e}import{useEffect as de,useRef as ce}from"react";import{shallowEqual as te}from"react-redux";function q(e){let i=ce(e);return de(()=>{te(i.current,e)||(i.current=e)},[e]),te(i.current,e)?i.current:e}var ge=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Te=ge(),Re=()=>typeof navigator<"u"&&navigator.product==="ReactNative",De=Re(),xe=()=>Te||De?le:F,me=xe(),Ae=e=>e.isUninitialized?{...e,isUninitialized:!1,isFetching:!0,isLoading:e.data===void 0,status:Qe.pending}:e;function ie({api:e,moduleOptions:{batch:i,hooks:{useDispatch:T,useSelector:R,useStore:m},unstable__sideEffectsInRender:D,createSelector:c},serializeQueryArgs:h,context:E}){let k=D?t=>t():F;return{buildQueryHooks:U,buildMutationHook:z,usePrefetch:j};function _(t,o,y){if(o?.endpointName&&t.isUninitialized){let{endpointName:u}=o,l=E.endpointDefinitions[u];h({queryArgs:o.originalArgs,endpointDefinition:l,endpointName:u})===h({queryArgs:y,endpointDefinition:l,endpointName:u})&&(o=void 0)}let Q=t.isSuccess?t.data:o?.data;Q===void 0&&(Q=t.data);let s=Q!==void 0,n=t.isLoading,r=(!o||o.isLoading||o.isUninitialized)&&!s&&n,a=t.isSuccess||n&&s;return{...t,data:Q,currentData:t.data,isFetching:n,isLoading:r,isSuccess:a}}function j(t,o){let y=T(),Q=q(o);return V((s,n)=>y(e.util.prefetch(t,s,{...Q,...n})),[t,y,Q])}function U(t){let o=(s,{refetchOnReconnect:n,refetchOnFocus:r,refetchOnMountOrArgChange:a,skip:u=!1,pollingInterval:l=0,skipPollingIfUnfocused:p=!1}={})=>{let{initiate:b}=e.endpoints[t],d=T(),f=O(void 0);if(!f.current){let M=d(e.internalActions.internal_getRTKQSubscriptions());f.current=M}let A=G(u?K:s,ee,E.endpointDefinitions[t],t),g=q({refetchOnReconnect:n,refetchOnFocus:r,pollingInterval:l,skipPollingIfUnfocused:p}),S=O(!1),x=O(void 0),{queryCacheKey:P,requestId:H}=x.current||{},N=!1;P&&H&&(N=f.current.isRequestSubscribed(P,H));let v=!N&&S.current;return k(()=>{S.current=N}),k(()=>{v&&(x.current=void 0)},[v]),k(()=>{let M=x.current;if(typeof process<"u",A===K){M?.unsubscribe(),x.current=void 0;return}let W=x.current?.subscriptionOptions;if(!M||M.arg!==A){M?.unsubscribe();let I=d(b(A,{subscriptionOptions:g,forceRefetch:a}));x.current=I}else g!==W&&M.updateSubscriptionOptions(g)},[d,b,a,A,g,v]),F(()=>()=>{x.current?.unsubscribe(),x.current=void 0},[]),B(()=>({refetch:()=>{if(!x.current)throw new Error(fe(38));return x.current?.refetch()}}),[])},y=({refetchOnReconnect:s,refetchOnFocus:n,pollingInterval:r=0,skipPollingIfUnfocused:a=!1}={})=>{let{initiate:u}=e.endpoints[t],l=T(),[p,b]=ne(w),d=O(void 0),f=q({refetchOnReconnect:s,refetchOnFocus:n,pollingInterval:r,skipPollingIfUnfocused:a});k(()=>{let S=d.current?.subscriptionOptions;f!==S&&d.current?.updateSubscriptionOptions(f)},[f]);let A=O(f);k(()=>{A.current=f},[f]);let g=V(function(S,x=!1){let P;return i(()=>{d.current?.unsubscribe(),d.current=P=l(u(S,{subscriptionOptions:A.current,forceRefetch:!x})),b(S)}),P},[l,u]);return F(()=>()=>{d?.current?.unsubscribe()},[]),F(()=>{p!==w&&!d.current&&g(p,!0)},[p,g]),B(()=>[g,p],[g,p])},Q=(s,{skip:n=!1,selectFromResult:r}={})=>{let{select:a}=e.endpoints[t],u=G(n?K:s,h,E.endpointDefinitions[t],t),l=O(void 0),p=B(()=>c([a(u),(g,S)=>S,g=>u],_,{memoizeOptions:{resultEqualityCheck:Z}}),[a,u]),b=B(()=>r?c([p],r,{devModeChecks:{identityFunctionCheck:"never"}}):p,[p,r]),d=R(g=>b(g,l.current),Z),f=m(),A=p(f.getState(),l.current);return me(()=>{l.current=A},[A]),d};return{useQueryState:Q,useQuerySubscription:o,useLazyQuerySubscription:y,useLazyQuery(s){let[n,r]=y(s),a=Q(r,{...s,skip:r===w}),u=B(()=>({lastArg:r}),[r]);return B(()=>[n,a,u],[n,a,u])},useQuery(s,n){let r=o(s,n),a=Q(s,{selectFromResult:s===K||n?.skip?void 0:Ae,...n}),{data:u,status:l,isLoading:p,isSuccess:b,isError:d,error:f}=a;return re({data:u,status:l,isLoading:p,isSuccess:b,isError:d,error:f}),B(()=>({...a,...r}),[a,r])}}}function z(t){return({selectFromResult:o,fixedCacheKey:y}={})=>{let{select:Q,initiate:s}=e.endpoints[t],n=T(),[r,a]=ne();F(()=>()=>{r?.arg.fixedCacheKey||r?.reset()},[r]);let u=V(function(W){let I=n(s(W,{fixedCacheKey:y}));return a(I),I},[n,s,y]),{requestId:l}=r||{},p=B(()=>Q({fixedCacheKey:y,requestId:r?.requestId}),[y,r,Q]),b=B(()=>o?c([p],o):p,[o,p]),d=R(b,Z),f=y==null?r?.arg.originalArgs:void 0,A=V(()=>{i(()=>{r&&a(void 0),y&&n(e.internalActions.removeMutationResult({requestId:l,fixedCacheKey:y}))})},[n,y,r,l]),{endpointName:g,data:S,status:x,isLoading:P,isSuccess:H,isError:N,error:v}=d;re({endpointName:g,data:S,status:x,isLoading:P,isSuccess:H,isError:N,error:v});let M=B(()=>({...d,originalArgs:f,reset:A}),[d,f,A]);return B(()=>[u,M],[u,M])}}}var se=Symbol(),oe=({batch:e=Se,hooks:i={useDispatch:Be,useSelector:he,useStore:Ee},createSelector:T=be,unstable__sideEffectsInRender:R=!1,...m}={})=>({name:se,init(D,{serializeQueryArgs:c},h){let E=D,{buildQueryHooks:k,buildMutationHook:_,usePrefetch:j}=ie({api:D,moduleOptions:{batch:e,hooks:i,unstable__sideEffectsInRender:R,createSelector:T},serializeQueryArgs:c,context:h});return L(E,{usePrefetch:j}),L(h,{batch:e}),{injectEndpoint(U,z){if(J(z)){let{useQuery:t,useLazyQuery:o,useLazyQuerySubscription:y,useQueryState:Q,useQuerySubscription:s}=k(U);L(E.endpoints[U],{useQuery:t,useLazyQuery:o,useLazyQuerySubscription:y,useQueryState:Q,useQuerySubscription:s}),D[`use${C(U)}Query`]=t,D[`useLazy${C(U)}Query`]=o}else if(Y(z)){let t=_(U);L(E.endpoints[U],{useMutation:t}),D[`use${C(U)}Mutation`]=t}}}}});export*from"@reduxjs/toolkit/query";import{formatProdErrorMessage as Me}from"@reduxjs/toolkit";import{configureStore as Ue}from"@reduxjs/toolkit";import{useContext as ke}from"react";import{useEffect as Pe}from"react";import ue from"react";import{Provider as Oe,ReactReduxContext as Fe}from"react-redux";import{setupListeners as Ne}from"@reduxjs/toolkit/query";function ve(e){let i=e.context||Fe;if(ke(i))throw new Error(Me(35));let[R]=ue.useState(()=>Ue({reducer:{[e.api.reducerPath]:e.api.reducer},middleware:m=>m().concat(e.api.middleware)}));return Pe(()=>e.setupListeners===!1?void 0:Ne(R.dispatch,e.setupListeners),[e.setupListeners,R.dispatch]),ue.createElement(Oe,{store:R,context:i},e.children)}var _t=Le(we(),oe());export{ve as ApiProvider,w as UNINITIALIZED_VALUE,_t as createApi,oe as reactHooksModule,se as reactHooksModuleName};
//# sourceMappingURL=rtk-query-react.browser.mjs.map